define(["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var ShapeDefinition = {
        L: ["001", "111", "000"].join(""),
        I: ["0000", "1111", "0000", "0000"].join(""),
        T: ["010", "111", "000"].join(""),
        S: ["011", "110", "000"].join(""),
        Z: ["110", "011", "000"].join(""),
        O: ["011", "011", "000"].join(""),
        J: ["100", "111", "000"].join("")
    };
    var Tetramino = /** @class */ (function () {
        function Tetramino(id, x, y) {
            if (x === void 0) { x = 0; }
            if (y === void 0) { y = 0; }
            this.x = x;
            this.y = y;
            this._shapes = [];
            this.rotation = 0;
            this.ID = id.toUpperCase();
            var shape = ShapeDefinition[this.ID];
            var s = [], n = Math.sqrt(shape.length);
            for (var i = 0; i < n; i++) {
                s[i] = [];
                for (var j = 0; j < n; j++) {
                    s[i][j] = parseInt(shape[j + i * n]);
                }
            }
            this._shapes.push(s);
            var r = 3, t;
            while (this.ID !== "O" && r-- !== 0) {
                t = [];
                for (var i = 0; i < n; i++) {
                    t[i] = [];
                    for (var j = 0; j < n; j++) {
                        t[i][j] = s[n - j - 1][i];
                    }
                }
                s = t.slice(0);
                this._shapes.push(s);
            }
        }
        Tetramino.prototype.setTo = function (control, id) {
            if (id === void 0) { id = this.ID; }
            var shape = this._shapes[this.rotation];
            for (var i = 0; i < shape.length; i++) {
                for (var j = 0; j < shape.length; j++) {
                    if (shape[j][i]) {
                        control[this.x + i][this.y + j].setType(id);
                    }
                }
            }
        };
        Tetramino.prototype.check = function (control, dx, dy, dr) {
            if (dx === void 0) { dx = 0; }
            if (dy === void 0) { dy = 0; }
            if (dr === void 0) { dr = null; }
            dr = dr ? this.getRotation(dr) : this.rotation;
            var x = this.x + dx, y = this.y + dy, w = control.length, h = control[0].length, shape = this._shapes[dr];
            for (var i = 0; i < shape.length; i++) {
                for (var j = 0; j < shape.length; j++) {
                    if (shape[j][i]) {
                        if (!(0 <= x + i && x + i < w && 0 <= y + j && y + j < h) ||
                            control[x + i][y + j].solid) {
                            return false;
                        }
                    }
                }
            }
            return true;
        };
        Tetramino.prototype.toString = function () {
            var str = "";
            for (var i = 0; i < this._shapes.length; i++) {
                str += "\n";
                var _shape = this._shapes[i];
                for (var j = 0; j < _shape.length; j++) {
                    for (var k = 0; k < _shape[j].length; k++) {
                        str += _shape[j][k] ? "#" : ".";
                    }
                    str += "\n";
                }
            }
            return str;
        };
        Tetramino.prototype.setRotation = function (dr) {
            this.rotation = this.getRotation(dr);
        };
        Tetramino.prototype.getRotation = function (dr) {
            var r = this.rotation;
            if (dr > 0) {
                return (r + 1) % this._shapes.length;
            }
            return r - 1 >= 0 ? r - 1 : this._shapes.length - 1;
        };
        return Tetramino;
    }());
    exports.Tetramino = Tetramino;
    var TetraminoType;
    (function (TetraminoType) {
        TetraminoType["L"] = "L";
        TetraminoType["I"] = "I";
        TetraminoType["T"] = "L";
        TetraminoType["S"] = "S";
        TetraminoType["Z"] = "Z";
        TetraminoType["O"] = "O";
        TetraminoType["J"] = "J";
    })(TetraminoType = exports.TetraminoType || (exports.TetraminoType = {}));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV0cmFtaW5vLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidGV0cmFtaW5vLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztJQUFBLElBQU0sZUFBZSxHQUFHO1FBQ3BCLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNqQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQzVDLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNqQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDakMsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ2pDLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNqQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7S0FDcEMsQ0FBQTtJQUVEO1FBS0ksbUJBQVksRUFBVSxFQUFTLENBQWEsRUFBUyxDQUFhO1lBQW5DLGtCQUFBLEVBQUEsS0FBYTtZQUFTLGtCQUFBLEVBQUEsS0FBYTtZQUFuQyxNQUFDLEdBQUQsQ0FBQyxDQUFZO1lBQVMsTUFBQyxHQUFELENBQUMsQ0FBWTtZQUoxRCxZQUFPLEdBQWUsRUFBRSxDQUFDO1lBQ2pDLGFBQVEsR0FBRyxDQUFDLENBQUM7WUFJVCxJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxX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